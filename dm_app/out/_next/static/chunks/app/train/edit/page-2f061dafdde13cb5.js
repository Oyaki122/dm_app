(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{4115:function(e,n,t){Promise.resolve().then(t.bind(t,627))},6327:function(e,n,t){"use strict";t.d(n,{A7:function(){return c},EO:function(){return h},JE:function(){return v}});var i=t(9268),r=t(1822),l=t(6840),a=t(6720),s=t(4873),o=t(728),d=t(3862),u=t(157);function c(e){let{element:n}=e;return(0,i.jsx)(r.Tr,{children:n.map((e,n)=>(0,i.jsx)(l.Td,{children:e},n))})}function h(e){let{element:n}=e;return(0,i.jsx)(r.Tr,{children:n.map((e,n)=>(0,i.jsx)(l.Td,{children:e},n))})}function v(e){let{indexes:n,children:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.x,{children:(0,i.jsxs)(s.i,{variant:"simple",colorScheme:"gray",children:[(0,i.jsx)(o.h,{children:(0,i.jsx)(r.Tr,{children:n.map((e,n)=>(0,i.jsx)(d.Th,{children:e},n))})}),(0,i.jsx)(u.p,{children:t})]})})})}t(6006)},9360:function(e,n,t){"use strict";t.d(n,{_:function(){return i}});let i=e=>async(n,t)=>{let i={};i=void 0===t?{credentials:"include"}:{...t,credentials:"include"};let r=await fetch(n,i),l=await r.json();return e.parse(l)}},6196:function(e,n,t){"use strict";t.d(n,{x:function(){return r}});var i=t(2391);let r=i.z.object({range:i.z.array(i.z.object({train_id:i.z.number(),conductor_id:i.z.number(),driver_id:i.z.number(),station_id:i.z.number()}))})},4194:function(e,n,t){"use strict";t.d(n,{H:function(){return r}});var i=t(2391);let r=i.z.object({drivers:i.z.array(i.z.object({driver_id:i.z.number().positive().int(),name:i.z.string(),affilitation:i.z.string()}))})},2503:function(e,n,t){"use strict";t.d(n,{y:function(){return r}});var i=t(2391);let r=i.z.object({stations:i.z.array(i.z.object({station_id:i.z.number().positive().int(),name:i.z.string(),city:i.z.string(),line:i.z.string()}))})},4948:function(e,n,t){"use strict";t.d(n,{s:function(){return l}});var i=t(2391);let r=i.z.custom(e=>{if("number"!=typeof e)return!1;let n=e/100,t=e%100;return!(n<0)&&!(n>24)&&!(t<0)&&!(t>59)}),l=i.z.object({stops:i.z.array(i.z.object({train_id:i.z.number(),station_id:i.z.number(),arrival_time:r.nullish(),departure_time:r.nullish()}))})},8301:function(e,n,t){"use strict";t.d(n,{v:function(){return r}});var i=t(2391);let r=i.z.object({train:i.z.object({train_id:i.z.number(),origin:i.z.number(),destinaion:i.z.number(),car:i.z.number()})})},627:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var i=t(9268),r=t(8301),l=t(2503),a=t(6196),s=t(4194),o=t(4948),d=t(5846),u=t.n(d),c=t(5559),h=t(8823),v=t(1060),m=t(5134),f=t(2386),p=t(7932),x=t(6185),j=t(673),_=t(2127),b=t(160),g=t(2344),y=t(4658),z=t(2261),N=t(7400),I=t(1283),k=t(9745),C=t(9360),S=t(730),P=t(6327),F=t(6006),T=t(6008);function O(){var e,n,t,d,O,w,E;let q=(0,T.useRouter)(),R={slug:""};R.slug=null!==(e=new URLSearchParams(new URL(window.location.href).search).get("slug"))&&void 0!==e?e:"";let{data:L,error:B}=(0,S.ZP)("http://localhost:5000/api/train_detail/"+R.slug,(0,C._)(r.v)),{data:G,error:J}=(0,S.ZP)("http://localhost:5000/api/get_stations",(0,C._)(l.y)),H=null==G?void 0:G.stations,{data:D,error:Z}=(0,S.ZP)("http://localhost:5000/api/get_drivers",(0,C._)(s.H)),Q=null==D?void 0:D.drivers,{data:Y,error:$}=(0,S.ZP)("http://localhost:5000/api/crewRange/".concat(null==L?void 0:L.train.train_id),(0,C._)(a.x)),{data:A,error:U}=(0,S.ZP)("http://localhost:5000/api/stops/".concat(null==L?void 0:L.train.train_id),(0,C._)(o.s)),[M,X]=(0,F.useState)(null!==(n=null==L?void 0:L.train.origin)&&void 0!==n?n:0),[K,V]=(0,F.useState)(null!==(t=null==L?void 0:L.train.destinaion)&&void 0!==t?t:0);(0,F.useEffect)(()=>{var e,n;X(null!==(e=null==L?void 0:L.train.origin)&&void 0!==e?e:0),V(null!==(n=null==L?void 0:L.train.destinaion)&&void 0!==n?n:0)},[L]),console.log(B,J,Z,$,U);let[W,ee]=(0,F.useState)(null!==(d=null==Y?void 0:Y.range)&&void 0!==d?d:[]);(0,F.useEffect)(()=>{var e;ee(null!==(e=null==Y?void 0:Y.range)&&void 0!==e?e:[])},[Y]);let[en,et]=(0,F.useState)(null!==(O=null==A?void 0:A.stops)&&void 0!==O?O:[]);(0,F.useEffect)(()=>{var e;et(null!==(e=null==A?void 0:A.stops)&&void 0!==e?e:[])},[A]);let ei=async()=>{let e=fetch("http://localhost:5000/api/crewRange/".concat(null==L?void 0:L.train.train_id,"/edit"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:W})}),n=fetch("http://localhost:5000/api/stops/".concat(null==L?void 0:L.train.train_id,"/edit"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record:en})}),t=fetch("http://localhost:5000/api/train_detail/".concat(null==L?void 0:L.train.train_id,"/update"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...null==L?void 0:L.train,origin:M,destination:K})});await Promise.all([e,n,t]),q.push("/train/detail?slug=".concat(null==L?void 0:L.train.train_id))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.X,{as:"h2",size:"lg",children:"列車管理 編集"}),(0,i.jsxs)(h.U,{p:"1rem",spacing:"1rem",children:[(0,i.jsx)(v.xu,{p:"1rem",children:(0,i.jsxs)(c.X,{as:"h3",size:"md",children:["列車番号: ",null==L?void 0:L.train.train_id]})}),(0,i.jsxs)(m.k,{p:"1rem",children:[(0,i.jsxs)(f.NI,{children:[(0,i.jsx)(p.l,{children:"出発"}),(0,i.jsx)(x.P,{value:M,onChange:e=>X(parseInt(e.target.value,10)),children:null==H?void 0:H.map((e,n)=>(0,i.jsx)("option",{value:e.station_id,children:e.name},n))})]}),(0,i.jsxs)(f.NI,{children:[(0,i.jsx)(p.l,{children:"到着"}),(0,i.jsx)(x.P,{value:K,onChange:e=>V(parseInt(e.target.value,10)),children:null==H?void 0:H.map((e,n)=>(0,i.jsx)("option",{value:e.station_id,children:e.name},n))})]})]}),(0,i.jsx)(j.L,{}),(0,i.jsxs)(m.k,{children:[(0,i.jsx)(u(),{href:"/train/[slug]",as:"/train/".concat(null==L?void 0:L.train.train_id),children:(0,i.jsx)(_.z,{colorScheme:"red",children:"キャンセル"})}),(0,i.jsx)(_.z,{colorScheme:"blue",onClick:ei,children:"更新"})]})]}),(0,i.jsx)(v.xu,{p:"1rem",children:(0,i.jsxs)(b.m,{children:[(0,i.jsxs)(g.t,{children:[(0,i.jsx)(y.O,{children:"停車駅"}),(0,i.jsx)(y.O,{children:"乗務員"})]}),(0,i.jsxs)(z.n,{children:[(0,i.jsx)(N.x,{children:(0,i.jsx)(P.JE,{indexes:["駅","到着時間","出発時間"],children:null==en?void 0:en.map((e,n)=>{var t;return(0,i.jsx)(P.EO,{element:[(0,i.jsx)(I.x,{children:null==H?void 0:null===(t=H.find(n=>n.station_id===e.station_id))||void 0===t?void 0:t.name},n),(0,i.jsx)(f.NI,{children:(0,i.jsx)(k.I,{type:"number",value:null!==(w=e.arrival_time)&&void 0!==w?w:"",onChange:e=>(en[n].arrival_time=parseInt(e.target.value,10),et([...en]))})},n),(0,i.jsx)(f.NI,{children:(0,i.jsx)(k.I,{type:"number",value:null!==(E=e.departure_time)&&void 0!==E?E:"",onChange:e=>(en[n].departure_time=""===e.target.value?null:parseInt(e.target.value,10),et([...en]))})},n)]},n)})})}),(0,i.jsx)(N.x,{children:(0,i.jsx)(P.JE,{indexes:["駅","運転手"],children:null==W?void 0:W.map((e,n)=>{var t;return(0,i.jsx)(P.EO,{element:[(0,i.jsx)(I.x,{children:null==H?void 0:null===(t=H.find(n=>n.station_id===e.station_id))||void 0===t?void 0:t.name},n),(0,i.jsx)(f.NI,{children:(0,i.jsx)(x.P,{value:e.driver_id,onChange:e=>(W[n].driver_id=parseInt(e.target.value,10),ee([...W])),children:null==Q?void 0:Q.map((e,n)=>(0,i.jsx)("option",{value:e.driver_id,children:e.name},n))})},n)]},n)})})})]})]})})]})}},6008:function(e,n,t){e.exports=t(8170)},7932:function(e,n,t){"use strict";t.d(n,{l:function(){return u},n:function(){return c}});var i=t(2386),r=t(8710),l=t(5526),a=t(2424),s=t(2088),o=t(463),d=t(9268),u=(0,r.G)(function(e,n){var t;let r=(0,l.mq)("FormLabel",e),u=(0,a.Lr)(e),{className:h,children:v,requiredIndicator:m=(0,d.jsx)(c,{}),optionalIndicator:f=null,...p}=u,x=(0,i.NJ)(),j=null!=(t=null==x?void 0:x.getLabelProps(p,n))?t:{ref:n,...p};return(0,d.jsxs)(s.m.label,{...j,className:(0,o.cx)("chakra-form__label",u.className),__css:{display:"block",textAlign:"start",...r},children:[v,(null==x?void 0:x.isRequired)?m:f]})});u.displayName="FormLabel";var c=(0,r.G)(function(e,n){let t=(0,i.NJ)(),r=(0,i.e)();if(!(null==t?void 0:t.isRequired))return null;let l=(0,o.cx)("chakra-form__required-indicator",e.className);return(0,d.jsx)(s.m.span,{...null==t?void 0:t.getRequiredIndicatorProps(e,n),__css:r.requiredIndicator,className:l})});c.displayName="RequiredIndicator"},2386:function(e,n,t){"use strict";t.d(n,{NI:function(){return p},NJ:function(){return f},Q6:function(){return x},e:function(){return v}});var i=t(2027),r=t(4966),l=t(8710),a=t(5526),s=t(2424),o=t(2088),d=t(463),u=t(6006),c=t(9268),[h,v]=(0,i.k)({name:"FormControlStylesContext",errorMessage:"useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<FormControl />\" "}),[m,f]=(0,i.k)({strict:!1,name:"FormControlContext"}),p=(0,l.G)(function(e,n){let t=(0,a.jC)("Form",e),i=(0,s.Lr)(e),{getRootProps:l,htmlProps:v,...f}=function(e){let{id:n,isRequired:t,isInvalid:i,isDisabled:l,isReadOnly:a,...s}=e,o=(0,u.useId)(),c=n||`field-${o}`,h=`${c}-label`,v=`${c}-feedback`,m=`${c}-helptext`,[f,p]=(0,u.useState)(!1),[x,j]=(0,u.useState)(!1),[_,b]=(0,u.useState)(!1),g=(0,u.useCallback)((e={},n=null)=>({id:m,...e,ref:(0,r.lq)(n,e=>{e&&j(!0)})}),[m]),y=(0,u.useCallback)((e={},n=null)=>({...e,ref:n,"data-focus":(0,d.PB)(_),"data-disabled":(0,d.PB)(l),"data-invalid":(0,d.PB)(i),"data-readonly":(0,d.PB)(a),id:void 0!==e.id?e.id:h,htmlFor:void 0!==e.htmlFor?e.htmlFor:c}),[c,l,_,i,a,h]),z=(0,u.useCallback)((e={},n=null)=>({id:v,...e,ref:(0,r.lq)(n,e=>{e&&p(!0)}),"aria-live":"polite"}),[v]),N=(0,u.useCallback)((e={},n=null)=>({...e,...s,ref:n,role:"group"}),[s]),I=(0,u.useCallback)((e={},n=null)=>({...e,ref:n,role:"presentation","aria-hidden":!0,children:e.children||"*"}),[]);return{isRequired:!!t,isInvalid:!!i,isReadOnly:!!a,isDisabled:!!l,isFocused:!!_,onFocus:()=>b(!0),onBlur:()=>b(!1),hasFeedbackText:f,setHasFeedbackText:p,hasHelpText:x,setHasHelpText:j,id:c,labelId:h,feedbackId:v,helpTextId:m,htmlProps:s,getHelpTextProps:g,getErrorMessageProps:z,getRootProps:N,getLabelProps:y,getRequiredIndicatorProps:I}}(i),p=(0,d.cx)("chakra-form-control",e.className);return(0,c.jsx)(m,{value:f,children:(0,c.jsx)(h,{value:t,children:(0,c.jsx)(o.m.div,{...l({},n),className:p,__css:t.container})})})});p.displayName="FormControl";var x=(0,l.G)(function(e,n){let t=f(),i=v(),r=(0,d.cx)("chakra-form__helper-text",e.className);return(0,c.jsx)(o.m.div,{...null==t?void 0:t.getHelpTextProps(e,n),__css:i.helperText,className:r})});x.displayName="FormHelperText"},7106:function(e,n,t){"use strict";t.d(n,{K:function(){return a},Y:function(){return l}});var i=t(2386),r=t(463);function l(e){let{isDisabled:n,isInvalid:t,isReadOnly:i,isRequired:l,...s}=a(e);return{...s,disabled:n,readOnly:i,required:l,"aria-invalid":(0,r.Qm)(t),"aria-required":(0,r.Qm)(l),"aria-readonly":(0,r.Qm)(i)}}function a(e){var n,t,l;let a=(0,i.NJ)(),{id:s,disabled:o,readOnly:d,required:u,isRequired:c,isInvalid:h,isReadOnly:v,isDisabled:m,onFocus:f,onBlur:p,...x}=e,j=e["aria-describedby"]?[e["aria-describedby"]]:[];return(null==a?void 0:a.hasFeedbackText)&&(null==a?void 0:a.isInvalid)&&j.push(a.feedbackId),(null==a?void 0:a.hasHelpText)&&j.push(a.helpTextId),{...x,"aria-describedby":j.join(" ")||void 0,id:null!=s?s:null==a?void 0:a.id,isDisabled:null!=(n=null!=o?o:m)?n:null==a?void 0:a.isDisabled,isReadOnly:null!=(t=null!=d?d:v)?t:null==a?void 0:a.isReadOnly,isRequired:null!=(l=null!=u?u:c)?l:null==a?void 0:a.isRequired,isInvalid:null!=h?h:null==a?void 0:a.isInvalid,onFocus:(0,r.v0)(null==a?void 0:a.onFocus,f),onBlur:(0,r.v0)(null==a?void 0:a.onBlur,p)}}},9745:function(e,n,t){"use strict";t.d(n,{I:function(){return u}});var i=t(7106),r=t(8710),l=t(5526),a=t(2424),s=t(2088),o=t(463),d=t(9268),u=(0,r.G)(function(e,n){let{htmlSize:t,...r}=e,u=(0,l.jC)("Input",r),c=(0,a.Lr)(r),h=(0,i.Y)(c),v=(0,o.cx)("chakra-input",e.className);return(0,d.jsx)(s.m.input,{size:t,...h,__css:u.field,ref:n,className:v})});u.displayName="Input",u.id="Input"},1283:function(e,n,t){"use strict";t.d(n,{x:function(){return u}});var i=t(8710),r=t(5526),l=t(2424),a=t(2088),s=t(463),o=t(7873),d=t(9268),u=(0,i.G)(function(e,n){let t=(0,r.mq)("Text",e),{className:i,align:u,decoration:c,casing:h,...v}=(0,l.Lr)(e),m=(0,o.o)({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return(0,d.jsx)(a.m.p,{ref:n,className:(0,s.cx)("chakra-text",e.className),...m,...v,__css:t})});u.displayName="Text"},5134:function(e,n,t){"use strict";t.d(n,{k:function(){return a}});var i=t(8710),r=t(2088),l=t(9268),a=(0,i.G)(function(e,n){let{direction:t,align:i,justify:a,wrap:s,basis:o,grow:d,shrink:u,...c}=e;return(0,l.jsx)(r.m.div,{ref:n,__css:{display:"flex",flexDirection:t,alignItems:i,justifyContent:a,flexWrap:s,flexBasis:o,flexGrow:d,flexShrink:u},...c})});a.displayName="Flex"},7873:function(e,n,t){"use strict";function i(e){let n=Object.assign({},e);for(let e in n)void 0===n[e]&&delete n[e];return n}t.d(n,{o:function(){return i}})},6185:function(e,n,t){"use strict";t.d(n,{P:function(){return h}});var i=t(1373),r=t(7106),l=t(8710),a=t(5526),s=t(2424),o=t(2088),d=t(463),u=t(6006),c=t(9268),h=(0,l.G)((e,n)=>{var t;let l=(0,a.jC)("Select",e),{rootProps:u,placeholder:h,icon:v,color:m,height:p,h:x,minH:j,minHeight:_,iconColor:b,iconSize:g,...y}=(0,s.Lr)(e),[z,N]=function(e,n){let t={},i={};for(let[r,l]of Object.entries(e))n.includes(r)?t[r]=l:i[r]=l;return[t,i]}(y,s.oE),I=(0,r.Y)(N),k={paddingEnd:"2rem",...l.field,_focus:{zIndex:"unset",...null==(t=l.field)?void 0:t._focus}};return(0,c.jsxs)(o.m.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:m},...z,...u,children:[(0,c.jsx)(i.m,{ref:n,height:null!=x?x:p,minH:null!=j?j:_,placeholder:h,...I,__css:k,children:e.children}),(0,c.jsx)(f,{"data-disabled":(0,d.PB)(I.disabled),...(b||m)&&{color:b||m},__css:l.icon,...g&&{fontSize:g},children:v})]})});h.displayName="Select";var v=e=>(0,c.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,c.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),m=(0,o.m)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),f=e=>{let{children:n=(0,c.jsx)(v,{}),...t}=e,i=(0,u.cloneElement)(n,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,c.jsx)(m,{...t,className:"chakra-select__icon-wrapper",children:(0,u.isValidElement)(n)?i:null})};f.displayName="SelectIcon"},1373:function(e,n,t){"use strict";t.d(n,{m:function(){return s}});var i=t(463),r=t(8710),l=t(2088),a=t(9268),s=(0,r.G)(function(e,n){let{children:t,placeholder:r,className:s,...o}=e;return(0,a.jsxs)(l.m.select,{...o,ref:n,className:(0,i.cx)("chakra-select",s),children:[r&&(0,a.jsx)("option",{value:"",children:r}),t]})});s.displayName="SelectField"}},function(e){e.O(0,[559,845,782,787,253,961,744],function(){return e(e.s=4115)}),_N_E=e.O()}]);